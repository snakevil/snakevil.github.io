<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>OpenWrt BarrierBreaker 14.07-rc3 手记 | 天天蜕皮的大蛇 Re</title>
    <meta property="og:title" content="OpenWrt BarrierBreaker 14.07-rc3 手记 - 天天蜕皮的大蛇 Re">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2014-09-18T05:59:59&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2014-09-23T04:11:59&#43;08:00'>
        
    <meta name="Keywords" content="">
    <meta name="description" content="OpenWrt BarrierBreaker 14.07-rc3 手记">
        
    <meta name="author" content="Snakevil">
    <meta property="og:url" content="https://szen.in/2014/09/OpenWrt-BarrierBreaker_14_07_rc3%E6%89%8B%E8%AE%B0/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    


    
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://szen.in/">
                        天天蜕皮的大蛇 Re
                    </a>
                
                <p class="description">当下这个时代里最昂贵的，无过于代表了自我记忆的信息数据。</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://szen.in/">首页</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 40px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border-right: 1px solid #ddd;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        word-wrap: break-word;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content > nav > ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content li {
        margin: 0.5em 0;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print, screen and (max-width: 1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#1-外置存储---extroot">1 外置存储 - ExtRoot</a>
      <ul>
        <li><a href="#11-usb-hdd-分区">1.1 USB HDD 分区</a></li>
        <li><a href="#12-挂载-usb-hdd">1.2 挂载 USB HDD</a></li>
      </ul>
    </li>
    <li><a href="#2-局域网优化---dmz--upnp">2 局域网优化 - DMZ + UPnP</a>
      <ul>
        <li><a href="#21-lan">2.1 LAN</a></li>
        <li><a href="#22-wan">2.2 WAN</a></li>
        <li><a href="#23-配置-dmz-需光猫高级管理员权限">2.3 配置 DMZ （需光猫高级管理员权限）：</a></li>
        <li><a href="#24-配置-upnp-">2.4 配置 UPnP ：</a></li>
      </ul>
    </li>
    <li><a href="#3-科学上网---dnsmasq--ipset--shadowsocks">3 科学上网 - dnsmasq + ipset + shadowsocks</a>
      <ul>
        <li><a href="#31-配置-shadowsocks-libev">3.1 配置 shadowsocks-libev</a></li>
        <li><a href="#32-配置-dnsmasq-full">3.2 配置 dnsmasq-full</a></li>
        <li><a href="#33-配置-ipset">3.3 配置 ipset</a></li>
        <li><a href="#34-googlecom-示例">3.4 google.com （示例）</a></li>
      </ul>
    </li>
    <li><a href="#4-网络存储---lighttpd-webdav-暂无法实现">4 网络存储 - lighttpd （WebDAV 暂无法实现）</a>
      <ul>
        <li><a href="#41-替代-uhttpd">4.1 替代 uhttpd</a></li>
        <li><a href="#42-支持-webdav">4.2 支持 WebDAV</a></li>
      </ul>
    </li>
    <li><a href="#5-家庭多媒体共享---minidlna--pure-ftpd">5 家庭多媒体共享 - minidlna + pure-ftpd</a>
      <ul>
        <li><a href="#51-安装-minidlna">5.1 安装 minidlna</a></li>
        <li><a href="#52-安装-pure-ftpd">5.2 安装 pure-ftpd</a></li>
      </ul>
    </li>
    <li><a href="#6-脱机下载---aria2">6 脱机下载 - aria2</a>
      <ul>
        <li><a href="#61-安装-aria2">6.1 安装 aria2</a></li>
        <li><a href="#62-安装-webui">6.2 安装 WebUI</a></li>
      </ul>
    </li>
    <li><a href="#9-远程控制---ddns">9 远程控制 - DDNS</a>
      <ul>
        <li><a href="#91-3322">9.1 3322</a></li>
        <li><a href="#92-外部-ssh-访问">9.2 外部 SSH 访问</a></li>
        <li><a href="#93-外部-http-访问">9.3 外部 HTTP 访问</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if (leftPos < 220) {
                postToc.css({
                    width: leftPos - 10,
                    "margin-left": 0 - leftPos,
                });
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t,
                    },
                    process: {
                        position: "fixed",
                        top: 20,
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process);
            });
        }
    });
</script>

    <article class="post">
        <header>
            <h1 class="post-title">OpenWrt BarrierBreaker 14.07-rc3 手记</h1>
        </header>
        <date class="post-meta meta-date">
            2014年9月18日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"
                ><a href='https://szen.in/category/%E5%AE%B6%E5%BA%AD%E7%BB%84%E7%BD%91'
                    >家庭组网</a
                ></span
            >
            
        </div>
          
        <div class="clear" style="display: none;">
            <div class="toc-article">
                <div class="toc-title">文章目录</div>
            </div>
        </div>
        
        <div class="post-content">
            <p>[OpenWRT][] 新的大版本发布了第三个候选包，据说 Bug 收敛得很不错，几乎不影响正常使用了。正好我也期盼已久，果断给路由升级！</p>
<h2 id="1-外置存储---extroot">1 外置存储 - ExtRoot</h2>
<h3 id="11-usb-hdd-分区">1.1 USB HDD 分区</h3>
<h5 id="安装依赖和工具包">安装依赖和工具包：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install kmod-usb-storage kmod-fs-ext4 libext2fs block-mount fdisk e2fsprogs

reboot
</code></pre></td></tr></table>
</div>
</div><h5 id="挂载-usb-hdd-使用-fdisk-devsda-分成两个数据区">挂载 USB HDD ，使用 <code>fdisk /dev/sda</code> 分成两个数据区：</h5>
<ol>
<li>分区 /dev/sda1 大小 1G ，用于保存系统数据；</li>
<li>分区 /dev/sda2 为剩余大小，用于保存用户数据。</li>
</ol>
<h5 id="使用-ext4-文件系统格式化两个分区">使用 ext4 文件系统格式化两个分区：</h5>
<p>（USB HDD 大小超过 21G 时，对 dev/sda2 格式化操作才需要添加 <code>-m 1</code> 操作。）</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mkfs.ext4 -L overlay /dev/sda1
mkfs.ext4 -b <span style="color:#bd93f9">4096</span> -L data -m <span style="color:#bd93f9">1</span> /dev/sda2
</code></pre></td></tr></table>
</div>
</div><p>重置路由至初始（出厂）状态。</p>
<h3 id="12-挂载-usb-hdd">1.2 挂载 USB HDD</h3>
<h5 id="安装依赖包并启动-fstab-">安装依赖包并启动 fstab ：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install kmod-usb-storage kmod-fs-ext4 libext2fs block-mount

/etc/init.d/fstab <span style="color:#8be9fd;font-style:italic">enable</span>
</code></pre></td></tr></table>
</div>
</div><p>检查分区 /dev/sda1 是否存在，若不存在，<code>reboot</code> 一次。</p>
<h5 id="挂载系统分区-devsda1-">挂载系统分区 /dev/sda1 ：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">uci add fstab mount
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.enabled<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>/overlay
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.device<span style="color:#ff79c6">=</span>/dev/sda1
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.fstype<span style="color:#ff79c6">=</span>ext4
uci commit

mount -t ext4 /dev/sda1 /mnt
cp -ar /overlay/* /mnt/
</code></pre></td></tr></table>
</div>
</div><p><code>reboot</code> 之后，<code>df -h</code> 检查是否挂载成功。成功时命令输出结果应包含下行内容（忽略容量和使用占比）：</p>
<blockquote>
<pre><code>/dev/sda1               975.9M    140.6M    768.1M  15% /overlay
</code></pre></blockquote>
<h5 id="挂载-swap-虚拟内存">挂载 swap 虚拟内存：</h5>
<p>（一般为内存大小两倍。）</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">dd <span style="color:#ff79c6">if</span><span style="color:#ff79c6">=</span>/dev/zero <span style="color:#8be9fd;font-style:italic">of</span><span style="color:#ff79c6">=</span>/swap <span style="color:#8be9fd;font-style:italic">bs</span><span style="color:#ff79c6">=</span>1M <span style="color:#8be9fd;font-style:italic">count</span><span style="color:#ff79c6">=</span><span style="color:#bd93f9">128</span>
mkswap /swap

uci add fstab swap
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@swap<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.enabled<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@swap<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.device<span style="color:#ff79c6">=</span>/swap
uci commit
</code></pre></td></tr></table>
</div>
</div><h5 id="挂载数据分区-devsda2-">挂载数据分区 /dev/sda2 ：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mkdir /home

uci add fstab mount
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.enabled<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>/home
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.device<span style="color:#ff79c6">=</span>/dev/sda2
uci <span style="color:#8be9fd;font-style:italic">set</span> fstab.@mount<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.fstype<span style="color:#ff79c6">=</span>ext4
uci commit
</code></pre></td></tr></table>
</div>
</div><h5 id="确认挂载成功">确认挂载成功：</h5>
<p><code>reboot</code> 之后，<code>free</code> 检查 swap 是否挂载成功。成功时命令输出结果应包含下行内容（忽略使用大小）：</p>
<blockquote>
<pre><code>Swap:       131068            0       131068
</code></pre></blockquote>
<p><code>df -h</code> 检查数据分区是否挂载成功。成功时命令输出结果应包含下行内容（忽略容量和使用占比）：</p>
<blockquote>
<pre><code>/dev/sda2               824.7G     72.1M    816.3G   0% /home
</code></pre></blockquote>
<h5 id="迁移-root-家目录">迁移 root 家目录：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#8be9fd;font-style:italic">cd</span> /
chmod <span style="color:#bd93f9">0700</span> root
mv root home/
ln -s home/root
</code></pre></td></tr></table>
</div>
</div><h2 id="2-局域网优化---dmz--upnp">2 局域网优化 - DMZ + UPnP</h2>
<h3 id="21-lan">2.1 LAN</h3>
<h5 id="调整-mtu-">调整 MTU ：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">uci <span style="color:#8be9fd;font-style:italic">set</span> network.lan.mtu<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1492</span>
uci commit
</code></pre></td></tr></table>
</div>
</div><h5 id="调整网段略">调整网段（略）</h5>
<h3 id="22-wan">2.2 WAN</h3>
<h5 id="调整为静态地址1921681234">调整为静态地址（192.168.1.234）：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.proto<span style="color:#ff79c6">=</span>static
uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.ipaddr<span style="color:#ff79c6">=</span>192.168.1.234
uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.netmask<span style="color:#ff79c6">=</span>255.255.255.0
uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.gateway<span style="color:#ff79c6">=</span>192.168.1.1
uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.dns<span style="color:#ff79c6">=</span>114.114.115.115
uci commit
</code></pre></td></tr></table>
</div>
</div><h5 id="调整-mtu--1">调整 MTU ：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">uci <span style="color:#8be9fd;font-style:italic">set</span> network.wan.mtu<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1492</span>
uci commit
</code></pre></td></tr></table>
</div>
</div><h5 id="生效">生效：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/etc/init.d/network restart
</code></pre></td></tr></table>
</div>
</div><h3 id="23-配置-dmz-需光猫高级管理员权限">2.3 配置 DMZ （需光猫高级管理员权限）：</h3>
<p>在光猫中配置 DMZ 主机至 192.168.1.234 。</p>
<h3 id="24-配置-upnp-">2.4 配置 UPnP ：</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install luci-app-upnp

/etc/init.d/miniupnpd <span style="color:#8be9fd;font-style:italic">enable</span>
/etc/init.d/miniupnpd start
</code></pre></td></tr></table>
</div>
</div><h2 id="3-科学上网---dnsmasq--ipset--shadowsocks">3 科学上网 - dnsmasq + ipset + shadowsocks</h2>
<h3 id="31-配置-shadowsocks-libev">3.1 配置 shadowsocks-libev</h3>
<p>想办法从 <a href="http://shadowsocks.org/en/download/clients.html">shadowsocks 官网</a> 下载对应芯片的 [OpenWRT][] 包。</p>
<h5 id="安装">安装：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install shadowsocks-libev-polarssl_1.4.6_ar71xx.ipk
rm -f shadowsocks-libev-polarssl_1.4.6_ar71xx.ipk

sed -e <span style="color:#f1fa8c">&#39;s/ss-local/ss-redir/&#39;</span> /etc/init.d/shadowsocks &gt; shadowsocks
mv -f shadowsocks /etc/init.d/shadowsocks

/etc/init.d/shadowsocks <span style="color:#8be9fd;font-style:italic">enable</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="vi-etcshadowsocksjson-配置后启动本地端口-1080"><code>vi /etc/shadowsocks.json</code> 配置后启动（本地端口 1080）：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/etc/init.d/shadowsocks start
</code></pre></td></tr></table>
</div>
</div><h3 id="32-配置-dnsmasq-full">3.2 配置 dnsmasq-full</h3>
<h5 id="安装-1">安装：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install dnsmasq-full

mkdir /etc/dnsmasq.d
<span style="color:#8be9fd;font-style:italic">echo</span> conf-dir<span style="color:#ff79c6">=</span>/etc/dnsmasq.d &gt; /etc/dnsmasq.conf

cat &gt; /etc/dnsmasq.d/ipset.shadowsocks.org <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">server=/.shadowsocks.org/208.67.220.220#443
</span><span style="color:#f1fa8c">ipset=/.shadowsocks.org/shadow
</span><span style="color:#f1fa8c">END</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="33-配置-ipset">3.3 配置 ipset</h3>
<h5 id="安装其中-1080-为-shadowsocks-本地端口">安装（其中 1080 为 shadowsocks 本地端口）：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install iptables-mod-nat-extra ipset

cat &gt; /etc/rc.local <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">/usr/sbin/ipset -N shadow iphash
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">exit 0
</span><span style="color:#f1fa8c">END</span>
cat &gt; /etc/firewall.user <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">/usr/sbin/iptables -t nat -A prerouting_rule -p tcp -m set --match-set shadow dst -j REDIRECT --to-port 1080
</span><span style="color:#f1fa8c">END</span>

sh /etc/rc.local
sh /etc/firewall.user
</code></pre></td></tr></table>
</div>
</div><h3 id="34-googlecom-示例">3.4 google.com （示例）</h3>
<h5 id="配置">配置：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cat &gt; /etc/dnsmasq.d/ipset.google.com <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">server=/.google.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.google.com.hk/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.google.co.jp/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.gstatic.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.ggpht.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.googleusercontent.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.googlecode.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.googleapis.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.gmail.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.google-analytics.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.googlevideo.com/208.67.220.220#443
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">ipset=/.google.com/shadow
</span><span style="color:#f1fa8c">ipset=/.google.com.hk/shadow
</span><span style="color:#f1fa8c">ipset=/.google.co.jp/shadow
</span><span style="color:#f1fa8c">ipset=/.gstatic.com/shadow
</span><span style="color:#f1fa8c">ipset=/.ggpht.com/shadow
</span><span style="color:#f1fa8c">ipset=/.googleusercontent.com/shadow
</span><span style="color:#f1fa8c">ipset=/.googlecode.com/shadow
</span><span style="color:#f1fa8c">ipset=/.googleapis.com/shadow
</span><span style="color:#f1fa8c">ipset=/.gmail.com/shadow
</span><span style="color:#f1fa8c">ipset=/.google-analytics.com/shadow
</span><span style="color:#f1fa8c">ipset=/.googlevideo.com/shadow
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">server=/.youtube.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.youtube-nocookie.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.ytimg.com/208.67.220.220#443
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">ipset=/.youtube.com/shadow
</span><span style="color:#f1fa8c">ipset=/.youtube-nocookie.com/shadow
</span><span style="color:#f1fa8c">ipset=/.ytimg.com/shadow
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">server=/.appspot.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.blogspot.com/208.67.220.220#443
</span><span style="color:#f1fa8c">server=/.blogger.com/208.67.220.220#443
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">ipset=/.appspot.com/shadow
</span><span style="color:#f1fa8c">ipset=/.blogspot.com/shadow
</span><span style="color:#f1fa8c">ipset=/.blogger.com/shadow
</span><span style="color:#f1fa8c">END</span>
</code></pre></td></tr></table>
</div>
</div><h5 id="生效-1">生效：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/etc/init.d/dnsmasq restart
</code></pre></td></tr></table>
</div>
</div><h2 id="4-网络存储---lighttpd-webdav-暂无法实现">4 网络存储 - lighttpd （WebDAV 暂无法实现）</h2>
<h3 id="41-替代-uhttpd">4.1 替代 uhttpd</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">/etc/init.d/uhttpd disable
/etc/init.d/uhttpd stop

opkg install lighttpd-mod-cgi

mv /etc/lighttpd/lighttpd.conf /etc/lighttpd/lighttpd.conf.opkg
cat &gt; /etc/lighttpd/lighttpd.conf <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">index-file.names = ( &#34;index.html&#34; )
</span><span style="color:#f1fa8c">mimetype.assign = (
</span><span style="color:#f1fa8c">  &#34;.html&#34;  =&gt; &#34;text/html&#34;,
</span><span style="color:#f1fa8c">  &#34;.htm&#34;   =&gt; &#34;text/html&#34;,
</span><span style="color:#f1fa8c">  &#34;.css&#34;   =&gt; &#34;text/css&#34;,
</span><span style="color:#f1fa8c">  &#34;.js&#34;    =&gt; &#34;text/javascript&#34;,
</span><span style="color:#f1fa8c">  &#34;.json&#34;  =&gt; &#34;application/json&#34;,
</span><span style="color:#f1fa8c">  &#34;.xml&#34;   =&gt; &#34;text/xml&#34;,
</span><span style="color:#f1fa8c">  &#34;.dtd&#34;   =&gt; &#34;text/xml&#34;,
</span><span style="color:#f1fa8c">  &#34;.txt&#34;   =&gt; &#34;text/plain&#34;,
</span><span style="color:#f1fa8c">  &#34;.bmp&#34;   =&gt; &#34;image/x-ms-bmp&#34;,
</span><span style="color:#f1fa8c">  &#34;.gif&#34;   =&gt; &#34;image/gif&#34;,
</span><span style="color:#f1fa8c">  &#34;.ico&#34;   =&gt; &#34;image/x-icon&#34;,
</span><span style="color:#f1fa8c">  &#34;.jpeg&#34;  =&gt; &#34;image/jpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.jpg&#34;   =&gt; &#34;image/jpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.png&#34;   =&gt; &#34;image/png&#34;,
</span><span style="color:#f1fa8c">  &#34;.svg&#34;   =&gt; &#34;image/svg+xml&#34;,
</span><span style="color:#f1fa8c">  &#34;.svgz&#34;  =&gt; &#34;image/svg+xml&#34;,
</span><span style="color:#f1fa8c">  &#34;.tif&#34;   =&gt; &#34;image/tiff&#34;,
</span><span style="color:#f1fa8c">  &#34;.tiff&#34;  =&gt; &#34;image/tiff&#34;,
</span><span style="color:#f1fa8c">  &#34;.3gp&#34;   =&gt; &#34;video/3gpp&#34;,
</span><span style="color:#f1fa8c">  &#34;.3gpp&#34;  =&gt; &#34;video/3gpp&#34;,
</span><span style="color:#f1fa8c">  &#34;.asf&#34;   =&gt; &#34;video/x-ms-asf&#34;,
</span><span style="color:#f1fa8c">  &#34;.asx&#34;   =&gt; &#34;video/x-ms-asf&#34;,
</span><span style="color:#f1fa8c">  &#34;.avi&#34;   =&gt; &#34;video/x-msvideo&#34;,
</span><span style="color:#f1fa8c">  &#34;.flv&#34;   =&gt; &#34;video/x-flv&#34;,
</span><span style="color:#f1fa8c">  &#34;.m4v&#34;   =&gt; &#34;video/mp4&#34;,
</span><span style="color:#f1fa8c">  &#34;.mng&#34;   =&gt; &#34;video/x-mng&#34;,
</span><span style="color:#f1fa8c">  &#34;.mkv&#34;   =&gt; &#34;video/x-matroska&#34;,
</span><span style="color:#f1fa8c">  &#34;.mov&#34;   =&gt; &#34;video/quicktime&#34;,
</span><span style="color:#f1fa8c">  &#34;.mp4&#34;   =&gt; &#34;video/mp4&#34;,
</span><span style="color:#f1fa8c">  &#34;.mpe&#34;   =&gt; &#34;video/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mpeg&#34;  =&gt; &#34;video/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mpg&#34;   =&gt; &#34;video/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.ogv&#34;   =&gt; &#34;video/ogg&#34;,
</span><span style="color:#f1fa8c">  &#34;.webm&#34;  =&gt; &#34;video/webm&#34;,
</span><span style="color:#f1fa8c">  &#34;.wmv&#34;   =&gt; &#34;video/x-ms-wmv&#34;,
</span><span style="color:#f1fa8c">  &#34;.kar&#34;   =&gt; &#34;audio/midi&#34;,
</span><span style="color:#f1fa8c">  &#34;.mid&#34;   =&gt; &#34;audio/midi&#34;,
</span><span style="color:#f1fa8c">  &#34;.midi&#34;  =&gt; &#34;audio/midi&#34;,
</span><span style="color:#f1fa8c">  &#34;.m4a&#34;   =&gt; &#34;audio/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mp2&#34;   =&gt; &#34;audio/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mp3&#34;   =&gt; &#34;audio/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mpga&#34;  =&gt; &#34;audio/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.mpega&#34; =&gt; &#34;audio/mpeg&#34;,
</span><span style="color:#f1fa8c">  &#34;.oga&#34;   =&gt; &#34;audio/ogg&#34;,
</span><span style="color:#f1fa8c">  &#34;.ogg&#34;   =&gt; &#34;audio/ogg&#34;,
</span><span style="color:#f1fa8c">  &#34;.ra&#34;    =&gt; &#34;audio/x-realaudio&#34;,
</span><span style="color:#f1fa8c">  &#34;.spx&#34;   =&gt; &#34;audio/ogg&#34;,
</span><span style="color:#f1fa8c">  &#34;.wav&#34;   =&gt; &#34;audio/x-wav&#34;,
</span><span style="color:#f1fa8c">  &#34;.weba&#34;  =&gt; &#34;audio/webm&#34;,
</span><span style="color:#f1fa8c">  &#34;.ai&#34;    =&gt; &#34;application/postscript&#34;,
</span><span style="color:#f1fa8c">  &#34;.doc&#34;   =&gt; &#34;application/msword&#34;,
</span><span style="color:#f1fa8c">  &#34;.docx&#34;  =&gt; &#34;application/vnd.openxmlformats-officedocument.wordprocessingml.document&#34;,
</span><span style="color:#f1fa8c">  &#34;.eps&#34;   =&gt; &#34;application/postscript&#34;,
</span><span style="color:#f1fa8c">  &#34;.ogx&#34;   =&gt; &#34;application/ogg&#34;,
</span><span style="color:#f1fa8c">  &#34;.pac&#34;   =&gt; &#34;application/x-ns-proxy-autoconfig&#34;,
</span><span style="color:#f1fa8c">  &#34;.pdf&#34;   =&gt; &#34;application/pdf&#34;,
</span><span style="color:#f1fa8c">  &#34;.ppt&#34;   =&gt; &#34;application/vnd.ms-powerpoint&#34;,
</span><span style="color:#f1fa8c">  &#34;.pptx&#34;  =&gt; &#34;application/vnd.openxmlformats-officedocument.presentationml.presentation&#34;,
</span><span style="color:#f1fa8c">  &#34;.ps&#34;    =&gt; &#34;application/postscript&#34;,
</span><span style="color:#f1fa8c">  &#34;.psd&#34;   =&gt; &#34;application/photoshop&#34;,
</span><span style="color:#f1fa8c">  &#34;.swf&#34;   =&gt; &#34;application/x-shockwave-flash&#34;,
</span><span style="color:#f1fa8c">  &#34;.xls&#34;   =&gt; &#34;application/vnd.ms-excel&#34;,
</span><span style="color:#f1fa8c">  &#34;.xlsx&#34;  =&gt; &#34;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#34;,
</span><span style="color:#f1fa8c">  &#34;.7z&#34;    =&gt; &#34;application/x-7z-compressed&#34;,
</span><span style="color:#f1fa8c">  &#34;.bz2&#34;   =&gt; &#34;application/bzip2&#34;,
</span><span style="color:#f1fa8c">  &#34;.dmg&#34;   =&gt; &#34;application/x-apple-diskimage&#34;,
</span><span style="color:#f1fa8c">  &#34;.gz&#34;    =&gt; &#34;application/gzip&#34;,
</span><span style="color:#f1fa8c">  &#34;.tar&#34;   =&gt; &#34;application/tar&#34;,
</span><span style="color:#f1fa8c">  &#34;.xz&#34;    =&gt; &#34;application/x-xz&#34;,
</span><span style="color:#f1fa8c">  &#34;.zip&#34;   =&gt; &#34;application/zip&#34;,
</span><span style="color:#f1fa8c">  &#34;&#34;       =&gt; &#34;application/octet-stream&#34;
</span><span style="color:#f1fa8c">)
</span><span style="color:#f1fa8c">server.document-root = &#34;/www&#34;
</span><span style="color:#f1fa8c">server.errorlog-use-syslog = &#34;enable&#34;
</span><span style="color:#f1fa8c">server.max-connections = 16
</span><span style="color:#f1fa8c">server.modules = ()
</span><span style="color:#f1fa8c">server.network-backend = &#34;write&#34;
</span><span style="color:#f1fa8c">server.pid-file = &#34;/var/run/lighttpd.pid&#34;
</span><span style="color:#f1fa8c">server.upload-dirs = ( &#34;/tmp&#34; )
</span><span style="color:#f1fa8c">static-file.exclude-extensions = ()
</span><span style="color:#f1fa8c">cgi.execute-x-only = &#34;enable&#34;
</span><span style="color:#f1fa8c">cgi.assign = ()
</span><span style="color:#f1fa8c">include &#34;luci.conf&#34;
</span><span style="color:#f1fa8c">END</span>
cat &gt; /etc/lighttpd/luci.conf <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">server.modules += ( &#34;mod_cgi&#34; )
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">\$HTTP[&#34;url&#34;] =~ &#34;^/cgi-bin/luci($|/)&#34; {
</span><span style="color:#f1fa8c">  cgi.assign += (
</span><span style="color:#f1fa8c">    &#34;cgi-bin/luci&#34; =&gt; &#34;&#34;
</span><span style="color:#f1fa8c">  )
</span><span style="color:#f1fa8c">}
</span><span style="color:#f1fa8c">END</span>

/etc/init.d/lighttpd <span style="color:#8be9fd;font-style:italic">enable</span>
/etc/init.d/lighttpd start
</code></pre></td></tr></table>
</div>
</div><h3 id="42-支持-webdav">4.2 支持 WebDAV</h3>
<p>（Lighttpd 对 WebDAV 最新规范地实现度也不足 100% ，以后再找找有没有更好的办法…）</p>
<h2 id="5-家庭多媒体共享---minidlna--pure-ftpd">5 家庭多媒体共享 - minidlna + pure-ftpd</h2>
<h3 id="51-安装-minidlna">5.1 安装 minidlna</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install minidlna

mkdir -p /home/dlna/data
mkdir /home/dlna/db

uci <span style="color:#8be9fd;font-style:italic">set</span> minidlna.config.db_dir<span style="color:#ff79c6">=</span>/home/dlna/db
uci <span style="color:#8be9fd;font-style:italic">set</span> minidlna.config.log_dir<span style="color:#ff79c6">=</span>/home/dlna
uci delete minidlna.config.media_dir
uci add_list minidlna.config.media_dir<span style="color:#ff79c6">=</span>/home/dlna/data
uci commit

/etc/init.d/minidlna <span style="color:#8be9fd;font-style:italic">enable</span>
/etc/init.d/minidlna start
</code></pre></td></tr></table>
</div>
</div><h3 id="52-安装-pure-ftpd">5.2 安装 pure-ftpd</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install pure-ftpd

uci <span style="color:#8be9fd;font-style:italic">set</span> pure-ftpd.@pure-ftpd<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.chrooteveryone<span style="color:#ff79c6">=</span><span style="color:#bd93f9">0</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> pure-ftpd.@pure-ftpd<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.enabled<span style="color:#ff79c6">=</span><span style="color:#bd93f9">1</span>
uci commit

/etc/init.d/pure-ftpd <span style="color:#8be9fd;font-style:italic">enable</span>
/etc/init.d/pure-ftpd start
</code></pre></td></tr></table>
</div>
</div><h2 id="6-脱机下载---aria2">6 脱机下载 - aria2</h2>
<h3 id="61-安装-aria2">6.1 安装 aria2</h3>
<p>官方源中的版本阉割掉了 BitTorrent 下载功能 :-( 所以得从 <a href="http://blog.nanpuyue.com/">南浦月</a> 的帖子 <a href="http://www.right.com.cn/forum/thread-135833-1-1.html">《luci-app-aria2、yaaw、aria2-1.18.3 下载》</a> 下载相应芯片的包。</p>
<p>（BT 下载速度非常差，原因有待深入研究…）</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">98
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install aria2_1.18.3-1_ar71xx.ipk

mkdir -p /home/aria/data
touch /home/aria/session
touch /home/aria/dht

cat &gt; /etc/aria2.conf <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">log=/home/aria/info.log
</span><span style="color:#f1fa8c">dir=/home/aria/data
</span><span style="color:#f1fa8c">file-allocation=trunc
</span><span style="color:#f1fa8c">continue=true
</span><span style="color:#f1fa8c">input-file=/home/aria/session
</span><span style="color:#f1fa8c">deferred-input=true
</span><span style="color:#f1fa8c">max-concurrent-downloads=10
</span><span style="color:#f1fa8c">quiet=false
</span><span style="color:#f1fa8c">log-level=error
</span><span style="color:#f1fa8c">remote-time=true
</span><span style="color:#f1fa8c">enable-rpc=true
</span><span style="color:#f1fa8c">rpc-listen-all=true
</span><span style="color:#f1fa8c">rpc-allow-origin-all=true
</span><span style="color:#f1fa8c">rpc-save-upload-metadata=true
</span><span style="color:#f1fa8c">disable-ipv6=true
</span><span style="color:#f1fa8c">save-session=/home/aria/session
</span><span style="color:#f1fa8c">max-connection-per-server=5
</span><span style="color:#f1fa8c">min-split-size=5M
</span><span style="color:#f1fa8c">max-download-result=100
</span><span style="color:#f1fa8c">retry-wait=15
</span><span style="color:#f1fa8c">disk-cache=64M
</span><span style="color:#f1fa8c">save-session-interval=60
</span><span style="color:#f1fa8c">user-agent=uTorrent/341(109279400)(30888)
</span><span style="color:#f1fa8c">max-overall-upload-limit=16K
</span><span style="color:#f1fa8c">listen-port=6801-6899
</span><span style="color:#f1fa8c">follow-torrent=true
</span><span style="color:#f1fa8c">seed-time=1440
</span><span style="color:#f1fa8c">seed-ratio=0
</span><span style="color:#f1fa8c">peer-id-prefix=-UT341-
</span><span style="color:#f1fa8c">enable-peer-exchange=true
</span><span style="color:#f1fa8c">enable-dht=true
</span><span style="color:#f1fa8c">dht-listen-port=6801-6899
</span><span style="color:#f1fa8c">bt-seed-unverified=true
</span><span style="color:#f1fa8c">bt-max-peers=96
</span><span style="color:#f1fa8c">bt-save-metadata=true
</span><span style="color:#f1fa8c">bt-enable-lpd=true
</span><span style="color:#f1fa8c">END</span>
cat &gt; bt-tracker <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">bt-tracker=
</span><span style="color:#f1fa8c">http://anisaishuu.de:2710/announce,
</span><span style="color:#f1fa8c">http://bigfoot1942.sektori.org:6969/announce,
</span><span style="color:#f1fa8c">http://bt.careland.com.cn:6969/announce,
</span><span style="color:#f1fa8c">http://exodus.desync.com/announce,
</span><span style="color:#f1fa8c">http://exodus.desync.com:6969/announce,
</span><span style="color:#f1fa8c">http://hdreactor.org:2710/announce,
</span><span style="color:#f1fa8c">http://i.bandito.org/announce,
</span><span style="color:#f1fa8c">http://shadowshq.yi.org:6969/announce.php,
</span><span style="color:#f1fa8c">http://tracker.ex.ua/announce,
</span><span style="color:#f1fa8c">http://tracker.nwps.ws:6969/announce,
</span><span style="color:#f1fa8c">http://tracker.trackerfix.com:80/announce,
</span><span style="color:#f1fa8c">http://tracker2.torrentino.com/announce,
</span><span style="color:#f1fa8c">http://tracker3.torrentino.com/announce
</span><span style="color:#f1fa8c">END</span>
awk <span style="color:#f1fa8c">&#39;BEGIN{ORS=&#34;&#34;}1;END{print&#34;\n&#34;}&#39;</span> bt-tracker &gt;&gt; /etc/aria2.conf
rm -f bt-tracker
cat &gt; /etc/init.d/aria2 <span style="color:#f1fa8c">&lt;&lt;END
</span><span style="color:#f1fa8c">#!/bin/sh /etc/rc.common
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">START=95
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">SERVICE_USE_PID=1
</span><span style="color:#f1fa8c">SERVICE_WRITE_PID=1
</span><span style="color:#f1fa8c">SERVICE_DAEMONIZE=1
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">start() {
</span><span style="color:#f1fa8c">    service_start /usr/bin/aria2c --conf-path=/etc/aria2.conf
</span><span style="color:#f1fa8c">}
</span><span style="color:#f1fa8c">
</span><span style="color:#f1fa8c">stop() {
</span><span style="color:#f1fa8c">    service_stop /usr/bin/aria2c
</span><span style="color:#f1fa8c">}
</span><span style="color:#f1fa8c">END</span>

/etc/init.d/aria2 <span style="color:#8be9fd;font-style:italic">enable</span>
/etc/init.d/aria2 start

uci add firewall rule
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.name<span style="color:#ff79c6">=</span>Allow-Aria2-RPC
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.src<span style="color:#ff79c6">=</span>wan
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.proto<span style="color:#ff79c6">=</span>tcp
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.dest_port<span style="color:#ff79c6">=</span><span style="color:#bd93f9">6800</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>ACCEPT
uci add firewall rule
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.name<span style="color:#ff79c6">=</span>Allow-Aria2-BT
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.src<span style="color:#ff79c6">=</span>wan
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.proto<span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;tcp udp&#34;</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.dest_port<span style="color:#ff79c6">=</span>6801-6899
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>ACCEPT
uci commit

/etc/init.d/firewall restart
</code></pre></td></tr></table>
</div>
</div><h3 id="62-安装-webui">6.2 安装 WebUI</h3>
<p>从 <a href="https://github.com/binux/yaaw">yaaw 项目官网</a> 下载 zip 包并上传至路由器。</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">opkg install unzip

<span style="color:#8be9fd;font-style:italic">cd</span> /home/aria
mv /root/yaaw-master.zip .
unzip yaaw-master.zip
rm -f yaaw-master.zip
mv yaaw-master webui
<span style="color:#8be9fd;font-style:italic">cd</span> /www
ln -s /home/aria/webui aria
</code></pre></td></tr></table>
</div>
</div><h2 id="9-远程控制---ddns">9 远程控制 - DDNS</h2>
<h3 id="91-3322">9.1 3322</h3>
<h5 id="配置计划任务userpassworddomain-自填">配置计划任务（USER、PASSWORD、DOMAIN 自填）：</h5>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#34;* * * * * /usr/bin/wget -qO - &#39;http://&lt;USER&gt;:&lt;PASSWORD&gt;@members.3322.net/dyndns/update?hostname=&lt;DOMAIN&gt;&#39; &gt; /dev/null 2&gt;&amp;1&#34;</span> &gt; /etc/crontabs/root
</code></pre></td></tr></table>
</div>
</div><h3 id="92-外部-ssh-访问">9.2 外部 SSH 访问</h3>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">uci add firewall rule
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.name<span style="color:#ff79c6">=</span>Allow-SSH
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.proto<span style="color:#ff79c6">=</span>tcp
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.src<span style="color:#ff79c6">=</span>wan
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.dest_port<span style="color:#ff79c6">=</span><span style="color:#bd93f9">22</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>ACCEPT
uci commit
</code></pre></td></tr></table>
</div>
</div><h3 id="93-外部-http-访问">9.3 外部 HTTP 访问</h3>
<p>（光猫会占很不智能地占用 80 端口…所以采用 86 端口。）</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#8be9fd;font-style:italic">echo</span> <span style="color:#f1fa8c">&#39;/usr/sbin/iptables -t nat -A prerouting_rule -p tcp -d 192.168.1.234 --dport 86 -j REDIRECT --to-port 80&#39;</span> &gt;&gt; /etc/firewall.user

uci add firewall rule
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.name<span style="color:#ff79c6">=</span>Allow-HTTP
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.src<span style="color:#ff79c6">=</span>wan
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.proto<span style="color:#ff79c6">=</span>tcp
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.dest_port<span style="color:#ff79c6">=</span><span style="color:#bd93f9">86</span>
uci <span style="color:#8be9fd;font-style:italic">set</span> firewall.@rule<span style="color:#ff79c6">[</span>-1<span style="color:#ff79c6">]</span>.target<span style="color:#ff79c6">=</span>ACCEPT
uci commit

/etc/init.d/firewall restart
</code></pre></td></tr></table>
</div>
</div>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://szen.in/">Snakevil</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://szen.in/2014/09/OpenWrt-BarrierBreaker_14_07_rc3%E6%89%8B%E8%AE%B0/">https://szen.in/2014/09/OpenWrt-BarrierBreaker_14_07_rc3%E6%89%8B%E8%AE%B0/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>

 

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/2014/07/etc-cron_d%E6%94%BB%E7%95%A5/">/etc/cron.d 攻略</a></li>
        
        <li><a href="/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%85%AD/">【译】第 19 章：Z 文件系统㈥</a></li>
        
        <li><a href="/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BA%94/">【译】第 19 章：Z 文件系统㈤</a></li>
        
        <li><a href="/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9B%9B/">【译】第 19 章：Z 文件系统㈣</a></li>
        
        <li><a href="/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%89/">【译】第 19 章：Z 文件系统㈢</a></li>
        
    </ul>
</div>



        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li>
                    <a href='https://szen.in/tag/OpenWRT'
                        >OpenWRT</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/Linux'
                        >Linux</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/MiniUPnPd'
                        >MiniUPnPd</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/Dnsmasq'
                        >Dnsmasq</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/ipset'
                        >ipset</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/LigHTTPd'
                        >LigHTTPd</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/MiniDLNA'
                        >MiniDLNA</a
                    >
                </li>
                
                <li>
                    <a href='https://szen.in/tag/Aria2'
                        >Aria2</a
                    >
                </li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "snakevil/blog.hugo"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
</div>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='//www.google.com/search' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://szen.in/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://szen.in/2020/05/Plex-vs-Emby-vs-Jellyfin-vs-Kodi-2020%E5%B9%B4%E6%B7%B1%E5%BA%A6%E6%AF%94%E8%BE%83/" title="【译】Plex vs. Emby vs. Jellyfin vs. Kodi——2020 年深度比较">【译】Plex vs. Emby vs. Jellyfin vs. Kodi——2020 年深度比较</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/Plex-vs-Emby-vs-Jellyfin-%E8%B0%81%E6%89%8D%E6%98%AF%E6%9C%80%E4%BC%98%E8%A7%A3/" title="【译】Plex vs. Emby vs. Jellyfin——谁才是最优解？">【译】Plex vs. Emby vs. Jellyfin——谁才是最优解？</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%85%AD/" title="【译】第 19 章：Z 文件系统㈥">【译】第 19 章：Z 文件系统㈥</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BA%94/" title="【译】第 19 章：Z 文件系统㈤">【译】第 19 章：Z 文件系统㈤</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%9B%9B/" title="【译】第 19 章：Z 文件系统㈣">【译】第 19 章：Z 文件系统㈣</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%89/" title="【译】第 19 章：Z 文件系统㈢">【译】第 19 章：Z 文件系统㈢</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%BA%8C/" title="【译】第 19 章：Z 文件系统㈡">【译】第 19 章：Z 文件系统㈡</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E7%AC%AC19%E7%AB%A0Z%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E4%B8%80/" title="【译】第 19 章：Z 文件系统㈠">【译】第 19 章：Z 文件系统㈠</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E5%B0%86HPE-ProLiant-Gen10-X3421%E6%89%93%E9%80%A0%E6%88%90%E5%8A%A0%E5%BC%BA%E7%89%88NAS/" title="将 HPE ProLiant Gen10 X3421 打造成加强版 NAS">将 HPE ProLiant Gen10 X3421 打造成加强版 NAS</a>
    </li>
    
    <li>
        <a href="https://szen.in/2020/05/%E6%AF%AB%E6%97%A0%E9%9A%90%E7%A7%81%E5%8F%AF%E8%A8%80%E7%9A%84cn%E5%9F%9F%E5%90%8DWHOIS%E4%BF%A1%E6%81%AF/" title="毫无隐私可言的 .cn 域名 WHOIS 信息">毫无隐私可言的 .cn 域名 WHOIS 信息</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://szen.in/category/Docker/">Docker (5)</a>
    </li>
    
    <li>
        <a href="https://szen.in/category/Linux/">Linux (8)</a>
    </li>
    
    <li>
        <a href="https://szen.in/category/%E5%8D%9A%E9%97%BB%E5%B9%BF%E8%AE%B0/">博闻广记 (7)</a>
    </li>
    
    <li>
        <a href="https://szen.in/category/%E5%AE%B6%E5%BA%AD%E7%BB%84%E7%BD%91/">家庭组网 (4)</a>
    </li>
    
    <li>
        <a href="https://szen.in/category/%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7/">开发技巧 (6)</a>
    </li>
    
    <li>
        <a href="https://szen.in/category/%E6%9D%82%E8%B0%88%E6%97%A5%E8%AE%B0/">杂谈日记 (2)</a>
    </li>
    
</ul>

    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
    <a href="https://szen.in/tag/Aria2/">Aria2</a>
    
    <a href="https://szen.in/tag/CNNIC/">CNNIC</a>
    
    <a href="https://szen.in/tag/Dnsmasq/">Dnsmasq</a>
    
    <a href="https://szen.in/tag/Docker/">Docker</a>
    
    <a href="https://szen.in/tag/Emby/">Emby</a>
    
    <a href="https://szen.in/tag/FreeBSD/">FreeBSD</a>
    
    <a href="https://szen.in/tag/FreeNAS/">FreeNAS</a>
    
    <a href="https://szen.in/tag/GNUMake/">GNUMake</a>
    
    <a href="https://szen.in/tag/Git/">Git</a>
    
    <a href="https://szen.in/tag/Gitolite/">Gitolite</a>
    
    <a href="https://szen.in/tag/GnuPG2/">GnuPG2</a>
    
    <a href="https://szen.in/tag/HDD/">HDD</a>
    
    <a href="https://szen.in/tag/HPE/">HPE</a>
    
    <a href="https://szen.in/tag/ICANN/">ICANN</a>
    
    <a href="https://szen.in/tag/Jellyfin/">Jellyfin</a>
    
    <a href="https://szen.in/tag/Kodi/">Kodi</a>
    
    <a href="https://szen.in/tag/LigHTTPd/">LigHTTPd</a>
    
    <a href="https://szen.in/tag/Linux/">Linux</a>
    
    <a href="https://szen.in/tag/Lua/">Lua</a>
    
    <a href="https://szen.in/tag/MiniDLNA/">MiniDLNA</a>
    
    <a href="https://szen.in/tag/MiniUPnPd/">MiniUPnPd</a>
    
    <a href="https://szen.in/tag/MoonScript/">MoonScript</a>
    
    <a href="https://szen.in/tag/NAS/">NAS</a>
    
    <a href="https://szen.in/tag/Nextcloud/">Nextcloud</a>
    
    <a href="https://szen.in/tag/Nginx/">Nginx</a>
    
    <a href="https://szen.in/tag/OpenWRT/">OpenWRT</a>
    
    <a href="https://szen.in/tag/Plex/">Plex</a>
    
    <a href="https://szen.in/tag/ProLiant/">ProLiant</a>
    
    <a href="https://szen.in/tag/RAID/">RAID</a>
    
    <a href="https://szen.in/tag/S6/">S6</a>
    
    <a href="https://szen.in/tag/SAML/">SAML</a>
    
    <a href="https://szen.in/tag/SSD/">SSD</a>
    
    <a href="https://szen.in/tag/SSO/">SSO</a>
    
    <a href="https://szen.in/tag/Samba/">Samba</a>
    
    <a href="https://szen.in/tag/Seafile/">Seafile</a>
    
    <a href="https://szen.in/tag/Stow/">Stow</a>
    
    <a href="https://szen.in/tag/Syncthing/">Syncthing</a>
    
    <a href="https://szen.in/tag/Ubuntu/">Ubuntu</a>
    
    <a href="https://szen.in/tag/WHOIS/">WHOIS</a>
    
    <a href="https://szen.in/tag/ZFS/">ZFS</a>
    
    <a href="https://szen.in/tag/crontab/">crontab</a>
    
    <a href="https://szen.in/tag/ipset/">ipset</a>
    
    <a href="https://szen.in/tag/ownCloud/">ownCloud</a>
    
    <a href="https://szen.in/tag/%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C/">我的世界</a>
    
    <a href="https://szen.in/tag/%E7%B3%BB%E7%BB%9F%E6%9E%84%E5%BB%BA/">系统构建</a>
    
    <a href="https://szen.in/tag/%E8%87%AA%E4%B8%BB%E7%BF%BB%E8%AF%91/">自主翻译</a>
    
</div>

    </section>

    

    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://szen.in/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="container">
        &copy; 2020 <a href="https://szen.in/">天天蜕皮的大蛇 Re by Snakevil</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.flysnow.org/" target="_blank">Theme</a> based on <a href="https://github.com/flysnow-org/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>


<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>







</body>

</html>